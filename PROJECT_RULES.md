# 项目开发规则

## 🎯 项目概述

**项目名称**: Jetson Orin 硬件控制项目 (b0)  
**主要功能**: GPIO、PWM、LED 和舵机控制  
**开发环境**: Jetson Orin 开发板 + Python  

## 📁 项目结构规范

### 目录结构
```
b0/
├── README.md                    # 项目主说明文档
├── PROJECT_RULES.md            # 项目开发规则 (本文件)
├── docs/                       # 文档目录
│   └── hardware.md             # 硬件连接说明
├── src/                        # 源代码目录
│   ├── __init__.py            # 包初始化文件
│   ├── gpio_control.py        # GPIO 控制器类
│   ├── pca9685_control.py     # PCA9685 PWM 控制器
│   └── software_pwm.py        # 软件 PWM 控制类
├── tools/                      # 测试工具集合
│   ├── README.md              # 工具使用说明
│   ├── git_cp.py              # 智能 Git 提交助手
│   └── tool_*.py              # 各种测试工具
├── requirements.txt            # Python 依赖
└── .gitignore                 # Git 忽略文件
```

### 文件命名规范
- **源代码文件**: 使用下划线命名，如 `gpio_control.py`
- **工具文件**: 以 `tool_` 开头，如 `tool_servo_channel_finder.py`
- **文档文件**: 使用下划线命名，如 `hardware.md`
- **配置文件**: 使用点号命名，如 `requirements.txt`

## 🛠️ 开发规范

### 代码风格
- **极简设计原则**: 单一职责，专注特定功能
- **最小化依赖**: 只使用必要的库
- **清晰的错误提示**: 提供有用的错误信息
- **优雅的资源清理**: 使用 `cleanup()` 方法或上下文管理器

### 硬件配置标准
- **I2C总线**: 固定使用总线 7
- **PCA9685地址**: 固定使用 0x40
- **PWM频率**: 舵机使用 50Hz
- **GPIO模式**: 默认使用 BOARD 模式

### 工具开发规范
1. **不要重复创建功能相似的工具**
2. **macOS环境限制**: 如果检测到macOS环境，不要创建模拟版本来演示功能
3. **将工具说明合并到主 README.md**
4. **工具应该简单易用，减少用户交互**
5. **固定配置**: 使用总线7，地址0x40，不要让用户选择
6. **持续输出**: 舵机测试工具应该持续输出PWM信号
7. **简单交互**: 按Enter键确认，Ctrl+C退出
8. **自动清理**: 程序结束时自动清理资源

## 📝 文档规范

### 文档结构
- **主 README.md**: 包含所有工具的说明，不要创建单独的说明文件
- **docs/hardware.md**: 硬件连接说明
- **tools/README.md**: 工具集合说明

### 文档内容要求
- 提供完整的使用步骤
- 包含配置信息
- 提供代码示例
- 说明预期结果和故障排除

## 🔧 工具分类

1. **核心工具**: 必须保留的工具
   - `tool_servo_channel_finder.py` - 舵机通道查找工具 ⭐
   - `tool_pca9685_debug.py` - PCA9685 调试工具
   - `tool_i2c_scan.py` - I2C 设备扫描
   - `git_cp.py` - 智能 Git 提交助手

2. **测试工具**: 基础功能测试
   - `tool_gpio_7.py` - GPIO 测试
   - `tool_pca9685_servo.py` - PCA9685 舵机测试
   - `tool_servo_pwm.py` - 软件 PWM 舵机测试

## 🚀 快速开发流程

### 1. 创建新工具
```bash
# 在 tools/ 目录下创建工具文件
# 使用固定配置，不要用户选择
# 添加执行权限
chmod +x tool_*.py
```

### 2. 更新文档
```bash
# 将工具说明添加到 tools/README.md
# 不要创建单独的说明文件
# 更新快速开始部分
```

### 3. 测试和提交
```bash
# 使用智能提交工具
python3 tools/git_cp.py
```

## 📋 提交规范

### 提交信息格式
使用 `git_cp.py` 自动生成提交信息，格式为：
```
操作类型: 文件描述
```

### 常见操作类型
- `新增源代码`: 添加新的 Python 文件
- `更新源代码`: 修改现有的 Python 文件
- `删除源代码`: 删除 Python 文件
- `新增文档`: 添加新的文档文件
- `更新文档`: 修改现有的文档文件
- `删除文档`: 删除文档文件
- `重构和优化`: 代码重构和优化

## ⚠️ 禁止事项

1. **不要创建功能重复的工具**
2. **不要创建单独的说明文档文件**
3. **不要每次让用户选择硬件配置**
4. **不要创建复杂的交互界面**
5. **不要保留不需要的文件**

## 🎯 项目目标

### 当前重点
- **舵机控制**: 专注于 PCA9685 舵机控制
- **工具简化**: 减少工具数量，提高易用性
- **文档统一**: 所有说明集中在主 README.md

### 开发原则
- **极简主义**: 只保留必要的功能
- **用户友好**: 减少用户配置和选择
- **自动化**: 使用工具自动化常见操作
- **一致性**: 保持代码和文档的一致性

## 📞 问题解决

### 常见问题
1. **舵机无响应**: 检查信号线连接，使用 `tool_servo_channel_finder.py`
2. **I2C设备未找到**: 使用 `tool_pca9685_debug.py` 诊断
3. **工具权限问题**: 某些工具需要 `sudo` 权限

### 调试流程
1. 使用 `tool_i2c_scan.py` 检查 I2C 设备
2. 使用 `tool_pca9685_debug.py` 诊断 PCA9685
3. 使用 `tool_servo_channel_finder.py` 测试舵机通道

## 🔄 开发进度

### 已完成功能
- [x] 项目基础结构
- [x] 硬件连接文档
- [x] GPIO 控制功能
- [x] 软件 PWM 控制功能
- [x] PCA9685 硬件 PWM 控制功能
- [x] LED 亮度控制
- [x] 舵机角度控制
- [x] 测试工具集合
- [x] 智能 Git 提交助手
- [x] 使用示例和教程
- [x] 项目规则文档

### 待完成功能
- [ ] 多通道同时控制
- [ ] 配置文件支持
- [ ] 更多传感器支持
- [ ] Web 界面控制

## ✅ 测试状态

### 功能测试
- ✅ GPIO 基础功能测试通过
- ✅ 软件 PWM 功能测试通过
- ✅ PCA9685 硬件 PWM 功能测试通过
- ✅ LED 亮度控制功能测试通过
- ✅ 舵机角度控制功能测试通过
- ✅ I2C 设备扫描功能测试通过

### 工具测试
- ✅ 所有测试工具正常工作
- ✅ 智能 Git 提交助手可用
- ✅ 错误处理和资源清理正常
- ✅ 用户交互友好

### 兼容性测试
- ✅ Jetson Orin 环境测试通过
- ✅ Python 3.x 兼容性测试通过
- ✅ 依赖库安装测试通过

---

**记住**: 保持简单，减少选择，自动化操作，统一文档。
